
<div id="question-folder-modal">
    <!-- Handlebars will inject content here -->
</div>

<script id="folder-template" type="text/x-handlebars-template">
    <div class="modal-header">
      <span class="modal-title">Th∆∞ m·ª•c c√¢u h·ªèi</span>
      <button class="close-button">√ó</button>
    </div>
    <div class="search-container">
      <input type="text" placeholder="T√¨m ki·∫øm th∆∞ m·ª•c..." class="search-bar">
    </div>
    <div id="folderList">
        {{#each questionList}}
            <div class="folder" data-folder-index="{{@index}}">

                <div class="folder-icon"></div>
                <div class="folder-info">
                  <div class="folder-name">{{name}}</div>
                  <div class="folder-details">
                    ‚â° {{questionCount}} c√¢u h·ªèi üìö {{subject}}
                  </div>
                </div>

            </div>
            
        {{/each}}
    </div>
</script>

<script id="question-template" type="text/x-handlebars-template">
    <div class="modal-header">
      <button class="back-button">Back to Folders</button>
      <span class="modal-title">{{name}}</span>
      
      <button class="close-button">√ó</button>
    </div>
    <div class="search-container">
      <input type="text" placeholder="T√¨m ki·∫øm c√¢u hoÃâi..." class="search-bar">
    </div>
    <div id="questionList">
        <div>{{name}} here</div>
        {{#each questions}}
            <div class="question">
                <strong>{{title}}</strong>: {{content}}<br>
                <em>Author: {{author}}, Date: {{date}}</em>
            </div>
        {{/each}}
    </div>
</script>

<script src="https://cdn.jsdelivr.net/npm/handlebars@4.7.7/dist/handlebars.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const data = {{{json questionList}}};
        const content = document.getElementById('question-folder-modal');

        const folderTemplateSource = document.getElementById('folder-template').innerHTML;
        const folderTemplate = Handlebars.compile(folderTemplateSource);
        content.innerHTML = folderTemplate({questionList: data});

        document.querySelectorAll('.folder').forEach(folderElement => {
            folderElement.addEventListener('click', function() {
                const folderIndex = this.getAttribute('data-folder-index');
                loadQuestions(data[folderIndex]);
            });
        });

        function loadQuestions(folder) {

            const questionTemplateSource = document.getElementById('question-template').innerHTML;
            const questionTemplate = Handlebars.compile(questionTemplateSource);
            content.innerHTML = questionTemplate(folder);

            document.querySelector('.back-button').addEventListener('click', function() {
                content.innerHTML = folderTemplate({questionList: data});
                attachFolderClickHandlers();
            });
        }

        function attachFolderClickHandlers() {
            document.querySelectorAll('.folder').forEach(folderElement => {
                folderElement.addEventListener('click', function() {
                    const folderIndex = this.getAttribute('data-folder-index');
                    loadQuestions(data[folderIndex]);
                });
            });
        }
    });
</script>
